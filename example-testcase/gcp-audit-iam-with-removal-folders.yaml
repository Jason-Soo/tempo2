#removing roles/storage.admin in specific project regex ^hypnotic-runway-.*
policies:
  - name: remove-service-account-permission
    resource: gcp.project
    filters:
      - type: value
        key: projectId
        op: regex
        value: "^hypnotic-runway-.*"
      - type: iam-policy
        doc:
          key: "bindings[*].members[]"
          op: intersect
          value: ["user:aventadorvip99@gmail.com"]
    actions:
      - type: set-iam-policy
        remove-bindings:
          - members:
              - user:aventadorvip99@gmail.com
            role: roles/storage.admin

# SCC version pending fix, it seems to be creating a chain reaction and continueously invoking