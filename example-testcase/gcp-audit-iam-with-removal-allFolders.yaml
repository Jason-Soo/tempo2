# removing roles/storage.admin in all project under a specific folder value
policies:
  - name: remove-service-account-permission
    resource: gcp.project
    query:
      - filter: "parent.id:825889333524 parent.type:folder"
    filters:
      - type: iam-policy
        doc:
          key: "bindings[*].members[]"
          op: intersect
          value: ["user:aventadorvip99@gmail.com"]
    actions:
      - type: set-iam-policy
        remove-bindings:
          - members:
              - user:aventadorvip99@gmail.com
            role: roles/storage.admin

# SCC version pending fix, it seems to be creating a chain reaction and continueously invoking